/*!
 * Annotations Support for Patterns - v0.3
 *
 * Copyright (c) 2013 Dave Olsen, http://dmolsen.com
 * Licensed under the MIT license
 *
 */var annotationsPattern={commentsOverlayActive:!1,commentsOverlay:!1,commentsOverlayElement:"",commentsEmbeddedActive:!1,commentsEmbedded:!1,showComments:function(){var e=document.getElementsByTagName("body");if(!e[0].classList.contains("sg-pattern-list"))for(i=0;i<comments.comments.length;i++){var t=comments.comments[i],n=document.querySelectorAll(t.el);for(var r=0;r<n.length;r++)n[r].onclick=function(e){return function(t){t.preventDefault();t.stopPropagation();var n={};if(annotationsPattern.commentsOverlayActive&&!annotationsPattern.commentsOverlay){annotationsPattern.commentsOverlay=!0;n={commentOverlay:"on",swapOverlay:!1,el:e.el,title:e.title,comment:e.comment}}else if(annotationsPattern.commentsOverlayActive&&annotationsPattern.commentsOverlay)if(e.el==annotationsPattern.commentsOverlayElement){annotationsPattern.commentsOverlay=!1;n={commentOverlay:"off"}}else n={commentOverlay:"on",swapOverlay:!0,el:e.el,title:e.title,comment:e.comment};annotationsPattern.commentsOverlayElement=e.el;var r=window.location.protocol=="file:"?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(n,r)}}(t)}},embedComments:function(e,t,n){var r=document.createElement("div");r.classList.add("sg-annotation");var i=document.createElement("h3"),s=document.createElement("p");i.innerHTML=t;s.innerHTML=n;r.appendChild(i);r.appendChild(s);var o=annotationsPattern.findParent(e),u=o.getElementsByClassName("sg-annotations");if(u.length>0)u[0].appendChild(r);else{var a=document.createElement("div");a.classList.add("sg-annotations");a.appendChild(r);o.appendChild(a)}},findParent:function(e){var t;if(e.parentNode.classList.contains("sg-pattern"))return e.parentNode;t=annotationsPattern.findParent(e.parentNode);return t},receiveIframeMessage:function(e){if(window.location.protocol!="file:"&&e.origin!==window.location.protocol+"//"+window.location.host)return;if(e.data.commentToggle!==undefined){var t,n,r;annotationsPattern.commentsOverlayActive=!1;annotationsPattern.commentsEmbeddedActive=!1;var i=document.getElementsByTagName("body");e.data.commentToggle==="on"&&i[0].classList.contains("sg-pattern-list")?annotationsPattern.commentsEmbeddedActive=!0:e.data.commentToggle==="on"&&(annotationsPattern.commentsOverlayActive=!0);if(!annotationsPattern.commentsOverlayActive){n=document.querySelectorAll(".has-comment");for(t=0;t<n.length;t++)n[t].classList.remove("has-comment")}if(!annotationsPattern.commentsEmbeddedActive){n=document.getElementsByClassName("sg-annotations");for(t=0;t<n.length;t++)n[t].style.display="none"}if(annotationsPattern.commentsOverlayActive)for(t=0;t<comments.comments.length;t++){r=comments.comments[t];n=document.querySelectorAll(r.el);for(k=0;k<n.length;k++)n[k].classList.add("has-comment")}else if(annotationsPattern.commentsEmbeddedActive&&!annotationsPattern.commentsEmbedded)for(t=0;t<comments.comments.length;t++){r=comments.comments[t];n=document.querySelectorAll(r.el);n.length>0&&annotationsPattern.embedComments(n[0],r.title,r.comment);annotationsPattern.commentsEmbedded=!0}else if(annotationsPattern.commentsEmbeddedActive&&annotationsPattern.commentsEmbedded){n=document.getElementsByClassName("sg-annotations");for(t=0;t<n.length;++t)n[t].style.display="block"}}}};annotationsPattern.showComments();window.addEventListener("message",annotationsPattern.receiveIframeMessage,!1);window.onbeforeunload=function(){var e={commentOverlay:"off"},t=window.location.protocol==="file:"?"*":window.location.protocol+"//"+window.location.host;parent.postMessage(e,t)};